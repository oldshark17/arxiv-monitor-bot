# 🤖 ArXiv Monitor Bot

Телеграм-бот для мониторинга научных статей с ArXiv.org с AI-суммаризацией на русском языке.

## ✨ Возможности

- 🔍 **Поиск статей** — поиск по ключевым словам через arXiv API
- 📬 **Подписки** — ежедневные уведомления о новых статьях по темам
- 🧠 **AI-суммаризация** — краткое содержание на русском через Gemini
- 📄 **Telegraph страницы** — удобное чтение прямо в Telegram

---

## 🏗 Архитектура

```
┌─────────────────┐     ┌──────────────┐     ┌─────────────┐
│  Telegram Bot   │────▶│   arXiv API  │────▶│   Gemini    │
│   (aiogram 3)   │     │  (официальный)│     │   2.5 Flash │
└────────┬────────┘     └──────────────┘     └─────────────┘
         │
         ▼
┌─────────────────┐     ┌──────────────┐
│    SQLite DB    │     │   Telegraph  │
│  (подписки)     │     │   (страницы) │
└─────────────────┘     └──────────────┘
```

---

## 🛠 Технологии

| Компонент | Технология | Назначение |
|-----------|------------|------------|
| Telegram бот | `aiogram 3.x` | Async фреймворк для ботов |
| База данных | `SQLite3` | Хранение подписок и seen papers |
| Поиск статей | `arxiv` (PyPI) | Официальный API arXiv |
| AI суммаризация | `google-genai` | Gemini 2.5 Flash |
| Публикация | `telegraph` | Создание страниц с контентом |
| Планировщик | `APScheduler` | Фоновые задачи мониторинга |

---

## 📊 База данных (SQLite)

```sql
-- Пользователи
users (user_id, created_at)

-- Подписки на темы
subscriptions (id, user_id, topic, frequency, last_checked, created_at)

-- Отправленные статьи (чтобы не дублировать)
seen_papers (id, user_id, subscription_id, arxiv_id, sent_at)
```

**Файл:** `src/arxiv_bot.db`

---

## 🤖 LLM Промпты

### Краткое содержание статьи
```
Ты — научный ассистент. Напиши краткое содержание статьи на русском языке.

Требования:
- 3-5 предложений
- Простым языком, понятным неспециалисту
- Основная идея, метод и результат

Абстракт статьи:
{abstract}
```

**Модель:** `gemini-2.5-flash`

---

## 📅 Мониторинг подписок

### Расписание arXiv
- **Обновления:** ВС-ЧТ в ~20:00 ET (~06:00 UTC+5)
- **Нет обновлений:** ПТ, СБ

### Логика проверки
```python
# Планировщик запускается каждый час в :00
scheduler.add_job(check_subscriptions, 'cron', minute=0)

# Пропускаем ПТ/СБ
if now.weekday() in {4, 5}:
    return

# Проверяем только после 06:00
if now.hour < 6:
    return

# Для каждой подписки проверяем, прошло ли 24 часа
if hours_since_last_check < 24:
    continue
```

---

## 📂 Структура проекта

```
arxiv-monitor-bot/
├── src/
│   ├── main.py          # Основная логика бота
│   ├── database.py      # Работа с SQLite
│   └── arxiv_bot.db     # База данных (создаётся автоматически)
├── requirements.txt     # Зависимости
├── .env                 # Токены (не в git)
└── README.md
```

---

## 🚀 Запуск

```bash
# 1. Клонировать
git clone https://github.com/oldshark17/arxiv-monitor-bot.git
cd arxiv-monitor-bot

# 2. Виртуальное окружение
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt

# 3. Настроить .env
echo "TELEGRAM_TOKEN=ваш_токен" > .env
echo "GEMINI_API_KEY=ваш_ключ" >> .env

# 4. Запустить
python src/main.py
```

---

## 🧪 Тестирование

- `/start` — главное меню
- `/test` — ручной запуск проверки подписок (игнорирует расписание)

---

## 📝 Команды бота

| Команда | Описание |
|---------|----------|
| `/start` | Главное меню (поиск / подписки) |
| `/test` | Принудительная проверка подписок |
